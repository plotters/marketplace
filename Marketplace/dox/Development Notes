   TO DO    ------------------------------------------------- 
   
          Ã can't add a 'recent' to 'favorites' (wrong ec)
            Fixed by moving the recent ad to the session ec
            while we manipulate it
            
            favorites is including old/all adverts
       
          Ã price echos in 'create advert' as \$10.00
          
          Ã 'cancel advert' keeps its data around so next
            time you create, you get the old data.
            
          Ã add new ads to the 'expanded' list(s)
            
            reset ad index after deletes in favorites -- else
            if you have 11 favorites and delete the 11th, the
            refresh stays on the 11th ad and an empty list is
            seen ...
            
          Ã don't show "price: $" if the price is null.
            
          Ã panel help button not found
            
          Ã panel help needs to be hooked up
            
          Ã move second advisory to test properties.
            
          Ã "wicked" error age title says "friend"
            
            - - - - - - - - - - - - - - - - - - - - - - - - -

            We don't store the cents of an entered price.  This would be
            tricky to fix since none of the legacy data contains cents so
            we'd need to mark the new currency entries in some way.
            
          Ã The "recent ads" list contains (up to) 50 ads.  When these
            are 'batched' in tens and the last batch is being displayed
            the ">" in the batch navigator is active -- it should not be
            since there are no more ads in the list.  I suspect we are
            gathering more ads into 'recent' than the arbitrary limit of
            50 and the real count is somehow being used.
            
            Expand/contract on ads stops working after a while.
            
          Ã We are allowing negative prices !!
            
          Ã Correct footer on error page
    
//---------------------------
    
    public Advert createNewAdvertTest(Author author, Category category) {
        
        logger.trace("--> createNewAdvertTest()");
//      CoreAssistance.prettyPrintEOEditingContext(_ec);
//      logger.trace("   Advert count: " + Advert.fetchAllAdverts(getEditingContext()).count());
        Advert          advert = Advert.createAdvert(getEditingContext(), author, category);
        advert.setPostedDate(new NSTimestamp());
        advert.setExpiryDate(new NSTimestamp(DateUtils.addDays(new NSTimestamp(), +7)));
        advert.setItemTitle("TESTING");
        advert.setItemDescription("Test Description");
//      CoreAssistance.prettyPrintEOEditingContext(_ec);
//      logger.trace("   Advert count: " + Advert.fetchAllAdverts(getEditingContext()).count());
        getEditingContext().saveChanges();
//      CoreAssistance.prettyPrintEOEditingContext(_ec);
//      logger.trace("   Advert count: " + Advert.fetchAllAdverts(getEditingContext()).count());
        return advert;
    }

    //---------------------------

    from UserSessionModel:
    
    
    /*
        public WOComponent addThing() {
        log.info("--> addThing(" + loopIndex + ")");
        Favorite.createFavorite(_ec, person.id(), things.objectAtIndex(loopIndex).id());
        _ec.saveChanges();
        myThings = Thing.fetchPersonThings(_ec, person);        // refresh the list
        return context().page();
    }

    public WOComponent subThing() {
        log.info("--> subThing(" + loopIndex + ")");
        NSArray<Favorite>   faves = Favorite.fetchByPersonAndThing(_ec, person, things.objectAtIndex(loopIndex));
        if (faves != null && faves.count() == 1) {
            _ec.deleteObject(faves.objectAtIndex(0));
            _ec.saveChanges();
            myThings = Thing.fetchPersonThings(_ec, person);    // refresh the list
        }
        return context().page();
    }
     */
    
    //----------------------------------------------------------------------------------------------------------------

    from Session.java

        {
            edu.umich.marketplace.eof.Author    author = getUserSessionModel().getAuthor();
            edu.umich.marketplace.eof.Advert    ad;
            
            getUserSessionModel().loadAuthorAdverts();
            ad = _app.getApplicationModel().createNewAdvertTest(author ,
                    _app.getApplicationModel().getEndCategories().objectAtIndex(0)); // TEST - VALUES CREATED IN MODEL
            getUserSessionModel().addIntoSelectAdverts(ad);
            getUserSessionModel().loadAuthorAdverts();
        }
        

    //
    
    from AdvertsPanel.wo
    
    <!--
<wo:if condition = "[session.adList.count]" negate = "true"><wo:if condition = "[modeIsCategory]" negate = "true">
    <b><wo:string value = "[session.emptyMessage]" /></b><br /><br /></wo:if></wo:if>

<wo:if condition = "[isShowSearch]"><br />
    <wo:submit action="[searchOnKeywords]" name="find" value="find" />
    <wo:textfield value="[searchTerms]" size="15" />
    <wo:if condition="[session.isAdWatch]" > in <wo:string value="[session.currentCategory.parent.name]" /> : 
                                                <wo:string value="[session.currentCategory.name]" /></wo:if><br /><br /></wo:if>

<wo:if condition="[session.isAdWatch]" negate="true" >
  <wo:if condition="[showBack]" ><br />
    <wo:submit action="[returnToCategory]" name="returnToCat" value="return to category" /><br /><br /></wo:if></wo:if>

<wo:if condition = "[showPostNewAd]"><wo:WOSubmitButton action = "[placeAd]" value = "place a new ad" />&nbsp;</wo:if>
<wo:if condition = "[showEditMyAds]"><wo:WOSubmitButton action = "[viewMyPostedAds]" value = "change status of my ad" /><br />
                            <wo:else><wo:if condition = "[session.adList.count]"><br /></wo:if></wo:else></wo:if>

-->
<wo:if condition = "[hasAdvertsToDisplay]"><br />
  <!--<table cellspacing = "0" cellpadding = "0" border = "0" width = "100%">
    <tr><td><wo:MPSorter /></td>
        <td align = "right"><wo:MPRangeChooser /></td></tr></table>--><br />

  <wo:AdvertListView workingItems = "[advertsToDisplay]" list = "[advertsToDisplay]" />
  <!-- <wo:WOComponentContent />-->
  <wo:MPBatcher />
</wo:if>
    
    